---
title: "dimension"
author: "Wenlan Zang and Michael J. Kane"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{dimension}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 7, 
  fig.height = 5
)
```

# Introduction

The `dimension` package provides an efficient way to determine the dimension f a signal rich subspace in a large matrix. It also provides a cleaned estimator of the original matrix and correlation matrix. Source code is maintained at [https://github.com/WenlanzZ/dimension](https://github.com/WenlanzZ/dimension).

The `dimension` package estimates the intrinsic dimension of a signal-rich subspace in large matrix "real- and complex value dense R matrices and real-valued saprse matrices from the `Matrix` package by decomposing matrix into a signal-plus-noise space and approximate the signal-rich subspace with a rank $K$ approximation $\hat{X}=\sum_{k=1}^{K}d_ku_k{v_k}^T$. To estimate rank $K$, it follows a simple procedure assuming that matrix $X$ is composed of a low-rank signal matrix $S$ and an average general noise random matrix $\bar{N}$. It has been shown that the average eigenvalues of random matrices $N$ follows a universal Marc\u{e}nko-Pastur (MP) distribution. We hypothesize that the deviation of eigenvalues of $X$ from the MP distribution indicates the intrinsic dimension of signal-rich subspace.

The package included the following main functions:

* subspace() - Greate a subspace class with scaled eigenvalue and eigenvectors and simulated noise eigenvalues for specified ranks.
* print.subspace()- Get a brief summary of subspace class.
* plot.subspace() - Get the scree plot of subspace class.
* dimension() - Get the dimension of a signal-subspace in a large high-dimensional matrix.
* clipped() - Get a cleaned estimator of the original matrix, its covairance matrix and correlation matrix.
* modified\_legacyplot() - Produces modified summary plots of bcp() output.

A demostration of the main functions and with a brief sample is as follow.

# Subspace

Let $x\in R^{n\times p}$ be a simulated multivariate normal matrix with $ncc$ correlated columns.

```{r setup}
library(devtools)
load_all()
x <- x_sim(n = 100, p = 150, ncc = 30, var = c(rep(10,5),rep(3,25)))
t1 <- proc.time()
Subspace <- subspace(x, components = 1:50, times = 10)
print(proc.time() - t1)
gc()
plot(Subspace, annotation = 30)
t2 <- proc.time()
results  <- dimension(subspace_ = Subspace)
# equivalently, if Subspace has not been calculated
results <- dimension(x, components = 1:50, times = 10)
print(proc.time() - t2)
gc()
str(results)
plot(results$Subspace, changepoint = results$dimension, annotation = 30)
modified_legacyplot(results$Changepoint$bcp_irl, annotation = 30)
modified_legacyplot(results$Changepoint$bcp_post, annotation = 30)
t3 <- proc.time()
TopSubspace <- subspace(x, components = 1:5, times = 10)
TopSubspace
MidSubspace <- subspace(x, components = 6:40, times = 10)
MidSubspace
print(proc.time() - t3)
gc()
plot(TopSubspace, changepoint = results$dimension, annotation = 5)
plot(MidSubspace, changepoint = results$dimension, annotation = 40)
```


